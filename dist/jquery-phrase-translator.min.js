!function(a,b,c,d){"use strict";function e(b){this.VERSION="1.2.1",this.options=a.extend({languageId:"en",altLanguageId:"en",classNames:"",onlyLang:"",fileName:"",callback:null,monitorAttr:!1,debug:!1,selectInConstructor:!0,attrList:["title","alt","placeholder"]},b||{});var c=this;this.phrases=this.phrases||{},this.jsonPhrasesList=[],this.addPhraseFile(this.options.fileName),this.childrenSelector="[lang"+(this.options.onlyLang?'="'+this.options.onlyLang+'"':"")+"]",this.globalSelector=":not(html)"+this.childrenSelector,this.classRegExpStr="",this.classRegExp="",this.addClassNames(this.options.classNames),this._jQueryMutationCopies={append:a.fn.append,appendTo:a.fn.appendTo,prepend:a.fn.prepend,before:a.fn.before,after:a.fn.after,html:a.fn.html,text:a.fn.text,attr:a.fn.attr,prop:a.fn.prop},a.fn.append=function(){return c._jQueryMutation(this,"append",arguments)},a.fn.appendTo=function(){return c._jQueryMutation(this,"appendTo",arguments)},a.fn.prepend=function(){return c._jQueryMutation(this,"prepend",arguments)},a.fn.before=function(){return c._jQueryMutation(this,"before",arguments)},a.fn.after=function(){return c._jQueryMutation(this,"after",arguments)},a.fn.html=function(){return c._jQueryMutation(this,"html",arguments)},a.fn.text=function(){return c._jQueryMutation(this,"text",arguments)},a.fn.prop=function(){return c._jQueryMutation(this,"prop",arguments)},this.options.monitorAttr&&(a.fn.attr=function(){return c._jQueryMutation(this,"attr",arguments)}),this.options.selectInConstructor&&a(function(){c.select(c.options.languageId,c.options.altLanguageId)})}b.PhraseTranslator=e,b.PhraseTranslator.prototype={fnGetText:function(a){return this._jQueryMutationCopies.text.call(a)},fnSetText:function(a,b){return this._jQueryMutationCopies.text.call(a,b)},fnGetAttr:function(a,b){return this._jQueryMutationCopies.attr.call(a,b)},fnSetAttr:function(a,b,c){return this._jQueryMutationCopies.attr.call(a,b,c)},_jQueryMutation:function(b,c,e){var f=this._jQueryMutationCopies[c].apply(b,e),g=a(b),h=this.fnGetAttr(g,"lang"),i=this.fnGetAttr(g,"class");if(h&&(!this.options.onlyLang||this.options.onlyLang==h)||this.classRegExp&&i!==d&&this.classRegExp.test(" "+i+" ")){if(0===e.length&&("text"==c||"html"==c))return f;if("attr"==c||"prop"==c)return(e.length>=2||a.isPlainObject(e[0]))&&this._translateAttr(g),f;this._translateElement(g)}return this._translateAll(g),f},_isValidPhraseId:function(a){return a?"#"==a.charAt(0):!1},_translateAll:function(b){var c=this;b=b?b.find(this.childrenSelector):a(this.globalSelector),b.each(function(){c._translateElement(a(this))})},_translateElement:function(a){var b="",c=a.data("phrase-translator-contents")||"",d=a.data("phrase-translator-contents-lang")||"",e=d!=this.options.languageId,f=!1;if(a.is("input"))switch(this.fnGetAttr(a,"type")){case"button":case"submit":case"reset":b=a.val(),f=!0}else{var g=a.contents().filter(function(){return 3===this.nodeType}).first();b=this.fnGetText(g)}this._isValidPhraseId(b)&&(c=b,e=!0),c&&e&&(b=this._translate(c),f?a.val(b):this.fnSetText(a,b)),this._translateAttr(a),a.data("phrase-translator-contents",c),a.data("phrase-translator-contents-lang",this.options.languageId)},_translateAttr:function(a){for(var b,c,d,e=a.data("phrase-translator-attr")||{},f=a.data("phrase-translator-attr-lang")||"",g=f!=this.options.languageId,h=0;h<this.options.attrList.length;h++)d=g,b=this.options.attrList[h],c=this.fnGetAttr(a,b)||"",this._isValidPhraseId(c)&&(e[b]=c,d=!0),e.hasOwnProperty(b)&&d&&this.fnSetAttr(a,b,this._translate(e[b]));a.data("phrase-translator-attr",e),a.data("phrase-translator-attr-lang",this.options.languageId)},_translate:function(a,b){return this._isValidPhraseId(a)?this.phrases[a.slice(1)]:b||a},translate:function(a,b,c){var d=this._translate("#"+a,c);if(b&&d)for(var e=0;e<b.length;e++)d=d.replace(b[e].mask,b[e].value);return d||"#"+a},addPhrases:function(a,b){this.jsonPhrasesList.push(a),b&&this.update()},addPhraseFile:function(b,c){b&&a.ajax({url:b,async:!1,dataType:"json",error:function(a){console.log('phrase-translator: Error loading "'+b+'".',"Error-text="+a.statusText+". Error-obj:",a)},success:a.proxy(this.addPhrases,this)}),c&&this.update()},addClassNames:function(b,c){b=b||"";var d,e,f=this.options.classNames.split(" ");for(d=0;d<f.length;d++)e=a.trim(f[d]),e&&(this.classRegExpStr+=(this.classRegExpStr?"|":"")+"\\s"+e+"\\s",this.addSelectors("."+e));this.classRegExp=this.classRegExpStr?new RegExp(this.classRegExpStr):null,c&&this.update()},addSelectors:function(b,c){var d,e;for(b=a.isArray(b)?b:[b],d=0;d<b.length;d++)e=b[d],this.childrenSelector+=","+e,this.globalSelector+=","+e;c&&this.update()},select:function(a,b){this.options.languageId=a,this.options.altLanguageId=b||this.options.altLanguageId||"en",this.update()},update:function(){var a,b,c,d,e;for(this.phrases={},a=0;a<this.jsonPhrasesList.length;a++){b=this.jsonPhrasesList[a];for(d in b)b.hasOwnProperty(d)&&(c=b[d],e=c[this.options.languageId],!e&&this.options.altLanguageId&&(e=c[this.options.altLanguageId],this.options.debug&&console.log('phrase-translator: "'+d+'" not defined for language "'+this.options.languageId+'". Using "'+e+'" from "'+this.options.altLanguageId+'" instead')),this.phrases[d]&&(e=e||this.phrases[d],this.options.debug&&console.log('phrase-translator: Two or more translations for  "'+d+'". Using "'+e+'"')),this.phrases[d]=e)}this._translateAll(),this.options.callback&&this.options.callback(this)}},a(function(){})}(jQuery,this,document);