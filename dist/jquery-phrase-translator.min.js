!function(t,n,e,s){"use strict";function a(n){var e=this;this.phrases=this.phrases||{},this.options=t.extend({languageId:"en",altLanguageId:"en",classNames:"",onlyLang:"",fileName:"phrases.xml",callback:null,monitorAttr:!1,debug:!1,selectInConstructor:!0,attrList:["title","alt","placeholder"]},n),this.childrenSelector="[lang"+(this.options.onlyLang?'="'+this.options.onlyLang+'"':"")+"]",this.globalSelector=":not(html)"+this.childrenSelector,this.classRegExp="";var a,i,r=this.options.classNames.split(" ");for(a=0;a<r.length;a++)i=t.trim(r[a]),i&&(this.classRegExp+=(this.classRegExp?"|":"")+"\\s"+i+"\\s",this.childrenSelector+=",."+i,this.globalSelector+=",."+i);this.classRegExp=this.classRegExp?this.classRegExp=new RegExp(this.classRegExp):null,this._jQueryMutationCopies={append:t.fn.append,appendTo:t.fn.appendTo,prepend:t.fn.prepend,before:t.fn.before,after:t.fn.after,html:t.fn.html,text:t.fn.text,attr:t.fn.attr,prop:t.fn.prop},this.fnGetText=function(t){return this._jQueryMutationCopies.text.call(t)},this.fnSetText=function(t,n){return this._jQueryMutationCopies.text.call(t,n)},this.fnGetAttr=function(t,n){return this._jQueryMutationCopies.attr.call(t,n)},this.fnSetAttr=function(t,n,e){return this._jQueryMutationCopies.attr.call(t,n,e)},t.fn.append=function(){return e._jQueryMutation(this,"append",arguments)},t.fn.appendTo=function(){return e._jQueryMutation(this,"appendTo",arguments)},t.fn.prepend=function(){return e._jQueryMutation(this,"prepend",arguments)},t.fn.before=function(){return e._jQueryMutation(this,"before",arguments)},t.fn.after=function(){return e._jQueryMutation(this,"after",arguments)},t.fn.html=function(){return e._jQueryMutation(this,"html",arguments)},t.fn.text=function(){return e._jQueryMutation(this,"text",arguments)},t.fn.prop=function(){return e._jQueryMutation(this,"prop",arguments)},this.options.monitorAttr&&(t.fn.attr=function(){return e._jQueryMutation(this,"attr",arguments)}),this._jQueryMutation=function(n,e,a){var i=this._jQueryMutationCopies[e].apply(n,a),r=t(n),o=this.fnGetAttr(r,"lang"),l=this.fnGetAttr(r,"class");if(o&&(!this.options.onlyLang||this.options.onlyLang==o)||this.classRegExp&&l!==s&&this.classRegExp.test(" "+l+" ")){if(0===a.length&&("text"==e||"html"==e))return i;if("attr"==e||"prop"==e)return(a.length>=2||t.isPlainObject(a[0]))&&this._translateAttr(r),i;this._translateElement(r)}return this._translateAll(r),i},this._isValidPhraseId=function(t){return t?"#"==t.charAt(0):!1},this.translatePhrase=function(t,n){return this._isValidPhraseId(t)?this.phrases[t.slice(1)]:n||t},this._translateAll=function(n){n=n?n.find(this.childrenSelector):t(this.globalSelector),n.each(function(){e._translateElement(t(this))})},this._translateElement=function(t){var n="",e=t.data("phrase-translator-contents")||"",s=t.data("phrase-translator-contents-lang")||"",a=s!=this.options.languageId,i=!1;if(t.is("input"))switch(this.fnGetAttr(t,"type")){case"button":case"submit":case"reset":n=t.val(),i=!0}else{var r=t.contents().filter(function(){return 3===this.nodeType}).first();n=this.fnGetText(r)}this._isValidPhraseId(n)&&(e=n,a=!0),e&&a&&(n=this.translatePhrase(e),i?t.val(n):this.fnSetText(t,n)),this._translateAttr(t),t.data("phrase-translator-contents",e),t.data("phrase-translator-contents-lang",this.options.languageId)},this._translateAttr=function(t){for(var n,e,s,a=t.data("phrase-translator-attr")||{},i=t.data("phrase-translator-attr-lang")||"",r=i!=this.options.languageId,o=0;o<this.options.attrList.length;o++)s=r,n=this.options.attrList[o],e=this.fnGetAttr(t,n)||"",this._isValidPhraseId(e)&&(a[n]=e,s=!0),a.hasOwnProperty(n)&&s&&this.fnSetAttr(t,n,this.translatePhrase(a[n]));t.data("phrase-translator-attr",a),t.data("phrase-translator-attr-lang",this.options.languageId)},this.select=function(n,e){this.options.languageId=n,this.options.altLanguageId=e||this.options.altLanguageId||"en";var s=this;e=this.options.altLanguageId,t.ajax({url:this.options.fileName,async:!1,contentType:"application/x-www-form-urlencoded;charset=iso-8859-1",success:function(a){t(a).find("phrase").each(function(){var a=t(this),i=s.fnGetAttr(a,"id"),r=a.find(n).text();!r&&e&&(r=a.find(e).text(),s.options.debug&&console.log('"'+i+'" not found in language "'+n+'". Used "'+r+'" from "'+e+'" instead')),s.phrases[i]=r}),s.options.languageId=n,s.options.altLanguageId=e||this.options.altLanguageId||"en",s._translateAll(),s.options.callback&&s.options.callback(s)},error:function(t){console.log("Error loading "+s.options.fileName+". Error="+t.statusText)}})},t(function(){e.options.selectInConstructor&&e.select(e.options.languageId,e.options.altLanguageId)})}n.PhraseTranslator=a}(jQuery,this,document);